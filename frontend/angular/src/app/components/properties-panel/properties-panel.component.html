<div class="properties-panel">
  <div class="panel-header">
    <h3>Propri√©t√©s</h3>
  </div>
  
  <div class="panel-content" *ngIf="selectedNode; else noSelection">
    <div class="node-info-card">
      <div class="node-header">
        <div class="node-avatar" [style.background-color]="getNodeColor()">
          <span class="node-icon">{{ getNodeIcon() }}</span>
        </div>
        <div class="node-title">
          <h4>{{ selectedNode.label }}</h4>
          <span class="node-subtitle">{{ getNodeTypeName() }}</span>
        </div>
      </div>
    </div>

    <form class="properties-form" (ngSubmit)="saveProperties()">
      <!-- Propri√©t√©s g√©n√©rales -->
      <div class="form-field">
        <label>Nom du n≈ìud</label>
        <input type="text" [(ngModel)]="selectedNode.label" name="label" class="form-input">
      </div>

      <!-- Propri√©t√©s sp√©cifiques par type de n≈ìud -->
      <div [ngSwitch]="selectedNode.type">
        
        <!-- Menu SVI -->
        <div *ngSwitchCase="'menu'" class="type-specific-properties">
          <h4>Configuration du menu</h4>
          
          <div class="form-field">
            <label>Message d'accueil</label>
            <textarea [(ngModel)]="selectedNode.data.welcomeMessage" name="welcomeMessage" rows="3" class="form-textarea"></textarea>
          </div>

          <div class="form-field">
            <label>Nombre maximum de tentatives</label>
            <input type="number" [(ngModel)]="selectedNode.data.maxAttempts" name="maxAttempts" min="1" max="5" class="form-input">
          </div>

          <div class="form-field">
            <label>Timeout (secondes)</label>
            <input type="number" [(ngModel)]="selectedNode.data.timeout" name="timeout" min="1" max="60" class="form-input">
          </div>

          <!-- Options du menu -->
          <div class="menu-options">
            <h5>Options du menu</h5>
            <div *ngFor="let option of getMenuOptions(); let i = index" class="menu-option">
              <div class="form-field">
                <label>Touche</label>
                <input type="text" [(ngModel)]="option.key" [name]="'optionKey' + i" maxlength="1" class="form-input">
              </div>
              <div class="form-field">
                <label>Description</label>
                <input type="text" [(ngModel)]="option.description" [name]="'optionDesc' + i" class="form-input">
              </div>
              <button type="button" (click)="removeMenuOption(i)" class="btn btn-danger btn-icon">
                <span>üóëÔ∏è</span>
              </button>
            </div>
            <button type="button" (click)="addMenuOption()" class="btn btn-outline">
              <span>‚ûï</span> Ajouter une option
            </button>
          </div>
        </div>

        <!-- Action -->
        <div *ngSwitchCase="'action'" class="type-specific-properties">
          <h4>Configuration de l'action</h4>
          
          <div class="form-field">
            <label>Type d'action</label>
            <select [(ngModel)]="selectedNode.data.actionType" name="actionType" class="form-select">
              <option value="playback">Lecture audio</option>
              <option value="record">Enregistrement</option>
              <option value="dtmf">Collecte DTMF</option>
              <option value="database">Requ√™te base de donn√©es</option>
            </select>
          </div>

          <div class="form-field" *ngIf="selectedNode.data.actionType === 'playback'">
            <label>Fichier audio</label>
            <input type="text" [(ngModel)]="selectedNode.data.audioFile" name="audioFile" class="form-input">
          </div>

          <div class="form-field" *ngIf="selectedNode.data.actionType === 'record'">
            <label>Dur√©e maximale (secondes)</label>
            <input type="number" [(ngModel)]="selectedNode.data.maxDuration" name="maxDuration" class="form-input">
          </div>
        </div>

        <!-- Condition -->
        <div *ngSwitchCase="'condition'" class="type-specific-properties">
          <h4>Configuration de la condition</h4>
          
          <div class="form-field">
            <label>Variable √† tester</label>
            <input type="text" [(ngModel)]="selectedNode.data.variable" name="variable" class="form-input">
          </div>

          <div class="form-field">
            <label>Op√©rateur</label>
            <select [(ngModel)]="selectedNode.data.operator" name="operator" class="form-select">
              <option value="equals">√âgal √†</option>
              <option value="notEquals">Diff√©rent de</option>
              <option value="contains">Contient</option>
              <option value="greaterThan">Sup√©rieur √†</option>
              <option value="lessThan">Inf√©rieur √†</option>
            </select>
          </div>

          <div class="form-field">
            <label>Valeur de comparaison</label>
            <input type="text" [(ngModel)]="selectedNode.data.value" name="value" class="form-input">
          </div>
        </div>

        <!-- Transfert -->
        <div *ngSwitchCase="'transfer'" class="type-specific-properties">
          <h4>Configuration du transfert</h4>
          
          <div class="form-field">
            <label>Type de transfert</label>
            <select [(ngModel)]="selectedNode.data.transferType" name="transferType" class="form-select">
              <option value="blind">Transfert aveugle</option>
              <option value="attended">Transfert surveill√©</option>
              <option value="queue">File d'attente</option>
            </select>
          </div>

          <div class="form-field">
            <label>Destination</label>
            <input type="text" [(ngModel)]="selectedNode.data.destination" name="destination" class="form-input">
          </div>

          <div class="form-field">
            <label>Timeout (secondes)</label>
            <input type="number" [(ngModel)]="selectedNode.data.timeout" name="transferTimeout" class="form-input">
          </div>
        </div>

        <!-- D√©marrage -->
        <div *ngSwitchCase="'start'" class="type-specific-properties">
          <h4>Configuration du d√©marrage</h4>
          
          <div class="form-field">
            <label>Message d'accueil</label>
            <textarea [(ngModel)]="selectedNode.data.welcomeMessage" name="startWelcome" rows="2" class="form-textarea"></textarea>
          </div>
        </div>

        <!-- Fin -->
        <div *ngSwitchCase="'end'" class="type-specific-properties">
          <h4>Configuration de fin</h4>
          
          <div class="form-field">
            <label>Message de fin</label>
            <textarea [(ngModel)]="selectedNode.data.goodbyeMessage" name="goodbyeMessage" rows="2" class="form-textarea"></textarea>
          </div>

          <div class="form-field">
            <label>Action apr√®s message</label>
            <select [(ngModel)]="selectedNode.data.endAction" name="endAction" class="form-select">
              <option value="hangup">Raccrocher</option>
              <option value="return">Retourner au menu principal</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Boutons d'action -->
      <div class="action-buttons">
        <button type="submit" class="btn btn-primary">
          <span>üíæ</span> Sauvegarder
        </button>
        <button type="button" (click)="resetProperties()" class="btn btn-secondary">
          <span>üîÑ</span> R√©initialiser
        </button>
        <button type="button" (click)="deleteNode()" class="btn btn-danger">
          <span>üóëÔ∏è</span> Supprimer
        </button>
      </div>
    </form>
  </div>

  <ng-template #noSelection>
    <div class="no-selection">
      <div class="large-icon">üëÜ</div>
      <h4>Aucun n≈ìud s√©lectionn√©</h4>
      <p>Cliquez sur un n≈ìud dans le canvas pour voir ses propri√©t√©s</p>
    </div>
  </ng-template>
</div>
